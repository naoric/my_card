<!DOCTYPE html>
<html>


<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Login</title>
	<link rel="stylesheet" href="css/jquery.mobile-1.3.0.min.css" />
	<script src="js/jquery-1.10.2.min.js"></script>
	<script src="js/jquery.mobile-1.3.0.min.js"></script>
	<script type="text/javascript" src="js/jquery.validate.min.js"></script>
</head>

<body>
	<!-- Home -->
	<div data-role="page" id="page1">
		<div data-theme="a" data-role="header">
			<h5>
				Login
			</h5>
		</div>
		<div data-role="content">
			<form action="http://redigo.me/login" method="post" id="myform">

				<input name="email" id="email" value="" type="text" placeholder="Enter email">

				<input name="password" id="password" value="" type="text" placeholder="Enter password">

				<button id="submit" type="submit" name="submit" value="submit" data-theme="b">Submit</button>

			</form>
		</div>
	</div>
	<div data-role="dialog" id="dialog">
		<div data-role="header">
		<h3>problem</h3>
		</div>
		<div data-role="content" data-theme="c">
			<h1>Bad email or password please re enter details</h1>
			<a href="login.html" data-role="button" data-rel="back" data-theme="c">OK</a>    
		</div>
	</div>
	<script type="text/javascript">
		$("#myform").validate({
			rules: {
				password: {
					required: true,
					minlength: 5
				},
				email: {
					required: true,
					email: true
				}
			},
			messages: {
				password: {
					required: "Please provide a password",
					minlength: "Your password must be at least 5 characters long"
				},

				email: {
					required: "Please enter a valid email address"
				}
			}
		});



		$(document).on('submit', '#myform', function(e) {
			e.preventDefault();
			if ($("#myform").valid()) {
				$.ajax({
					url: "http://redigo.me/login",
					type: "post",
					dataType: "json",
					data: $("#myform").serialize(),
					success: function(r) {
						console.log(r);
						if (r.status == "success") {
							$.mobile.changePage("customer_Home.html", {
								transition: "slideup"
							});
						} else {
                       $.mobile.changePage('#dialog', 'pop', true, true);

						}
					},
					error: function(e) {
						alert('not good');
					},
					beforeSend: function() {
						// This callback function will trigger before data is sent
						$.mobile.showPageLoadingMsg(true); // This will show ajax spinner
					}
				});
			}

		});
	</script>
</body>

</html>


